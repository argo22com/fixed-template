{%- comment -%}
  price-with-vat: zobrazí cenu s DPH.
  - očekává: price = variant.price (v centech)
  - DPH bere z metaobjektu vat_rates_by_country (price_multiplier), ale
    pokud je shop.taxes_included zapnuté, cenu už nenásobí.
{%- endcomment -%}
{%- liquid
  assign base_cents = price

  # multiplikátor DPH pro aktuální zemi (fallback = 1)
  assign mo = shop.metaobjects.vat_rates_by_country[ localization.country.iso_code ]
  assign multiplier = 1
  if mo and mo.price_multiplier and mo.price_multiplier.value
    assign multiplier = mo.price_multiplier.value
  endif

  # když jsou ceny v adminu už vč. DPH, multiplikátor nepoužijeme
  assign with_tax_cents = base_cents
  unless shop.taxes_included
    assign with_tax_cents = base_cents | times: multiplier | round: 0
  endunless
-%}
{% if with_tax_cents %}
  <span class="strong price__vat">
    {{ with_tax_cents | money_without_trailing_zeros }}
  </span>
{% endif %}
